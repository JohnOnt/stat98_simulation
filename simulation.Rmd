---
title: "R Notebook"
output:
  pdf_document: default
  pdf: default
---

```{r}
lambda <- 1/900
sims <- 800
n <- 15
tsamples <- replicate(sims, rexp(n, rate = lambda))
mu = 1/lambda

results <- as.numeric(sims)
t.int <- matrix(FALSE, sims, 2)
for (i in 1:sims) {
    t.int[i, ] <- t.test(tsamples[, i], conf.level = 0.95)$conf.int
    results[i] <- t.int[i, 1] < mu & t.int[i, 2] > mu
}
sum(results)/sims
```

```{r}
# Define functions for calculating estimates (to simplify code)

# For Normal and Poisson
get_estimate_NormPois <- function(data, indices) {
  return(mean(data[indices]))
}

# For Binomial Distribution
get_estimate_Binom <- function(data, indices) {
  return(mean(data[indices])/length(data[indices]))
}

# For Geometric Distribution
get_estimate_Geom <- function(data, indices) {
  return(1/mean(data[indices]))
}
```

```{r}
# Generate Da DATA
# FIVE Distributions
# Normal, Poisson, Binomial, Geometric, ¯\_(ツ)_/¯ distribution
n <- 100
normies <- rnorm(n) # continous and normal
poissis <- rpois(n, 2) # Continuous not normal
binnies <- rbinom(n, n, 0.7) # discrete normalish
geomies <- rgeom(n, 0.7) # discrete abnormal
```

```{r}
# T-test confidence intervals
```

```{r}
library(boot)

boot_out <- boot(
  data =normies,
  statistic = get_estimate_NormPois,
  R = 100
)

boot.ci(boot_out)
```
```{r}
boot.ci(boot_out)$basic[5]
```
